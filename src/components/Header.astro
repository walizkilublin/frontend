---
interface Props {
  phone: string;
}

const { phone } = Astro.props;
---

<header class="fixed top-0 inset-x-0 z-[5000] border-b border-border-tech bg-ghost-white/90 backdrop-blur-md transition-all duration-300" id="main-header">
  
  <div class="max-w-[1920px] mx-auto px-4 md:px-8 h-20 flex items-center justify-between relative z-[5002]">
    
    <a href="/" class="flex items-center group">
      <svg 
        viewBox="0 0 2816 1536" 
        class="h-12 md:h-16 w-auto transition-transform duration-500 ease-out group-hover:scale-[1.02] logo-svg"
        xmlns="http://www.w3.org/2000/svg"
        aria-label="Walizki Lublin Logo"
      >
        <path class="fill-current text-vantablack group-hover:text-signal-orange transition-colors duration-300 logo-primary" d="M 124.88363,1120.1412 V 974.13861 l 421.9906,0.021 421.99049,0.021 0.2595,100.73159 c 0.1426,55.4023 0.1423,121.0939 -8e-4,145.9814 l -0.2602,45.25 H 546.87343 124.88363 Z m 750.75879,-0.2476 0.2589,-52.75 H 546.89243 217.88363 v 52.3333 c 0,28.7834 0.3007,52.634 0.6682,53.0015 0.3675,0.3675 148.305,0.555 328.75,0.4167 l 328.08179,-0.2515 z m -750.50234,-309.50011 0.32308,-138.75 1.7526,-10.5 c 11.22035,-67.22225 44.66627,-119.73946 99.91467,-156.8871 23.1911,-15.59313 61.4608,-31.57661 82.9785,-34.65628 l 4.7253,-0.6763 0.4835,-3.14016 c 2.1586,-14.01718 3.0466,-18.51873 5.6034,-28.40346 24.3523,-94.1484 102.339,-157.7745 203.8509,-166.31346 l 14.3884,-1.21032 18.6116,0.58464 18.6116,0.58465 12.0359,2.02289 c 102.6036,17.24473 175.37059,89.95451 190.16299,190.01365 l 0.8011,5.41875 13,3.1408 c 105.6012,25.5133 176.9555,116.98358 176.7054,226.5217 -0.022,9.625 -0.077,70.0375 -0.1227,134.25 l -0.083,116.75 h -46.4726 -46.4726 l -0.315,-136.25 -0.3149,-136.25 -2.2355,-9.76203 c -12.0908,-52.80162 -50.0257,-91.05218 -105.1891,-106.06477 l -11.5,-3.1297 -81.18689,-0.31554 -81.1868,-0.31554 -0.3965,81.79379 -0.3966,81.79379 -1.677,10.4992 c -20.1159,125.93871 -115.6201,199.70069 -258.9062,199.96444 l -19.75,0.0364 -0.092,-73.75 c -0.051,-40.5625 -0.1513,-116.63624 -0.2236,-169.05276 l -0.1314,-95.30277 1.4737,-0.95177 c 1.9,-1.22716 12.66,-4.62072 20.9736,-6.61479 l 6.5,-1.55907 32.25,-0.47781 32.25,-0.4778 V 705.49113 828.0255 l 0.932,0.57601 c 3.046,1.88251 24.854,-9.40165 39.4169,-20.39554 l 9.498,-7.17027 7.6821,-8.69609 c 18.4223,-20.85384 29.4331,-42.96086 34.5535,-69.37524 l 1.9172,-9.89176 v -77.96454 -77.96454 h -76.0066 -76.0066 l -10.0288,1.50631 c -59.778,8.97852 -104.4735,51.86256 -117.7667,112.99369 l -1.5221,7 -0.3687,135.25 -0.3687,135.25 h -46.4992 -46.49922 z M 682.88363,463.01218 c 0,-2.32132 -6.3759,-19.64797 -10.0711,-27.36869 -21.3049,-44.51346 -69.9152,-73.5 -123.2592,-73.5 h -9.5736 l -14.2365,2.05495 -14.2365,2.05494 -10.9991,3.55577 c -43.8486,14.17531 -72.3893,42.00601 -86.6117,84.4571 -1.6568,4.94507 -3.0123,9.19043 -3.0123,9.43414 0,0.2437 61.2,0.4431 136,0.4431 h 136 z m 39,467.06559 c -24.1852,-1.66951 -53.8891,-8.30935 -75.2309,-16.81672 -25.9757,-10.35451 -57.9257,-31.30158 -76.1395,-49.91855 l -5.8704,-6.00035 0.8018,-1.34933 c 0.441,-0.74213 3.1311,-4.52076 5.9779,-8.39696 13.9501,-18.99422 25.4162,-41.44974 33.7535,-66.10356 l 5.4619,-16.15119 6.3141,9.64375 6.3141,9.64375 9.0587,9.36811 c 15.6033,16.13609 45.4125,35.14677 55.1109,35.14677 0.2786,0 0.4465,-55.2375 0.3732,-122.75 l -0.1334,-122.75 31.854,0.0626 31.8541,0.0626 8.99999,2.09776 c 4.95,1.15377 11.5888,3.07091 14.7529,4.2603 l 5.7529,2.16255 -0.2529,169.17707 -0.2529,169.17712 -23.5,0.11406 c -12.92499,0.0627 -28.67499,-0.24317 -34.99999,-0.67978 z"/>
        <path class="fill-current text-vantablack transition-colors duration-300 hidden sm:block logo-secondary" transform="matrix(2.081372,0,0,2.081372,-1030.4116,-12.360432)" d="m 1067.0774,449.7101 -44.16,-134.4 h 32.256 l 30.336,94.464 31.68,-94.464 h 28.8 l 30.72,95.232 31.296,-95.232 h 29.76 l -43.968,134.4 h -33.408 l -29.568,-91.008 -30.528,91.008 z m 241.5359,0 v -12.672 q -8.64,14.208 -31.488,14.208 -18.24,0 -28.416,-8.832 -10.176,-9.024 -10.176,-22.464 0,-13.632 10.368,-22.272 10.368,-8.64 33.984,-8.64 h 23.808 v 0 q 0,-9.6 -5.952,-14.976 -5.76,-5.376 -17.856,-5.376 -8.256,0 -16.32,2.688 -7.872,2.496 -13.44,6.912 l -10.752,-20.928 q 8.448,-5.952 20.352,-9.216 11.904,-3.264 24.192,-3.264 23.616,0 36.672,11.328 13.056,11.136 13.056,34.56 v 58.944 z m -1.92,-32.64 v -10.56 h -20.544 q -10.56,0 -14.592,3.456 -3.84,3.456 -3.84,8.64 0,5.76 4.416,9.216 4.608,3.264 12.48,3.264 7.488,0 13.44,-3.456 5.952,-3.648 8.64,-10.56 z m 57.0241,32.64 v -142.464 h 29.952 v 142.464 z m 57.7921,0 v -103.296 h 29.952 v 103.296 z m 14.976,-117.696 q -8.256,0 -13.44,-4.8 -5.184,-4.8 -5.184,-11.904 0,-6.912 5.184,-11.712 5.184,-4.992 13.44,-4.992 8.256,0 13.44,4.608 5.184,4.608 5.184,11.52 0,7.488 -5.184,12.48 -4.992,4.8 -13.44,4.8 z m 35.7122,117.696 v -18.048 l 52.608,-62.208 h -51.264 v -23.04 h 89.088 v 18.048 l -52.608,62.208 h 54.336 v 23.04 z m 111.3598,0 v -142.464 h 29.952 v 80.448 l 43.776,-41.28 h 35.712 l -43.008,43.776 46.848,59.52 h -36.288 l -32.448,-40.32 -14.592,14.016 v 26.304 z m 125.7602,0 v -103.296 h 29.952 v 103.296 z m 14.976,-117.696 q -8.256,0 -13.44,-4.8 -5.184,-4.8 -5.184,-11.904 0,-6.912 5.184,-11.712 5.184,-4.992 13.44,-4.992 8.256,0 13.44,4.608 5.184,4.608 5.184,11.52 0,7.488 -5.184,12.48 -4.992,4.8 -13.44,4.8 z"/>
        <path class="fill-current text-cool-grey transition-colors duration-300 hidden sm:block logo-tertiary" transform="matrix(1.4467441,0,0,1.4467441,-158.51336,108.10759)" d="m 1070.8066,597.61523 h 36.0938 v 112.6875 h 63.375 v 27.28125 h -99.4688 z m 119.7188,99.09375 v -64.125 h 33.75 v 10.5 q 0,8.53125 -0.094,21.46875 -0.094,12.84375 -0.094,17.15625 0,12.65625 0.6562,18.28125 0.6563,5.53125 2.25,8.0625 2.0625,3.28125 5.3438,5.0625 3.375,1.78125 7.6875,1.78125 10.5,0 16.5,-8.0625 6,-8.0625 6,-22.40625 v -51.84375 h 33.5625 v 105 h -33.5625 v -15.1875 q -7.5938,9.1875 -16.125,13.59375 -8.4375,4.3125 -18.6563,4.3125 -18.1875,0 -27.75,-11.15625 -9.4687,-11.15625 -9.4687,-32.4375 z m 193.6875,19.21875 q 10.7812,0 16.4062,-7.875 5.7188,-7.875 5.7188,-22.875 0,-15 -5.7188,-22.875 -5.625,-7.875 -16.4062,-7.875 -10.7813,0 -16.5938,7.96875 -5.7187,7.875 -5.7187,22.78125 0,14.90625 5.7187,22.875 5.8125,7.875 16.5938,7.875 z m -22.3125,-67.96875 q 6.9375,-9.1875 15.375,-13.5 8.4375,-4.40625 19.4062,-4.40625 19.4063,0 31.875,15.46875 12.4688,15.375 12.4688,39.65625 0,24.28125 -12.4688,39.75 -12.4687,15.375 -31.875,15.375 -10.9687,0 -19.4062,-4.3125 -8.4375,-4.40625 -15.375,-13.59375 v 15.1875 h -33.5625 v -145.875 h 33.5625 z m 103.875,-56.25 h 33.5625 v 145.875 h -33.5625 z m 65.8125,40.875 h 33.5625 v 105 h -33.5625 z m 0,-40.875 h 33.5625 v 27.375 h -33.5625 z m 171.375,81.9375 v 63.9375 h -33.75 v -10.40625 -38.53125 q 0,-13.59375 -0.6563,-18.75 -0.5625,-5.15625 -2.0625,-7.59375 -1.9687,-3.28125 -5.3437,-5.0625 -3.375,-1.875 -7.6875,-1.875 -10.5,0 -16.5,8.15625 -6,8.0625 -6,22.40625 v 51.65625 h -33.5625 v -105 h 33.5625 v 15.375 q 7.5937,-9.1875 16.125,-13.5 8.5312,-4.40625 18.8437,-4.40625 18.1875,0 27.5625,11.15625 9.4688,11.15625 9.4688,32.4375 z"/>
      </svg>
    </a>

    <nav class="hidden lg:flex items-center gap-10">
      <a href="#trust-bar" class="font-bold text-sm uppercase tracking-widest text-vantablack hover:text-signal-orange transition-colors">Dlaczego My</a>      
      <a href="#katalog" class="font-bold text-sm uppercase tracking-widest text-vantablack hover:text-signal-orange transition-colors">Katalog</a>
      <a href="#logistyka" class="font-bold text-sm uppercase tracking-widest text-vantablack hover:text-signal-orange transition-colors">Logistyka</a>
      <a href="#kontakt" class="font-bold text-sm uppercase tracking-widest text-vantablack hover:text-signal-orange transition-colors">Kontakt</a>
    </nav>

    <div class="flex items-center gap-4">
      <a 
        href={`tel:${phone.replace(/\s/g, '')}`} 
        class="flex items-center justify-center border-2 border-vantablack bg-transparent text-vantablack font-black uppercase tracking-widest h-12 px-4 md:px-8 hover:bg-vantablack hover:text-ghost-white transition-colors duration-300"
        id="cta-btn"
      >
        <span class="text-xs md:text-base">{phone}</span>
      </a>

      <button id="menu-toggle" class="lg:hidden relative w-12 h-12 flex items-center justify-center focus:outline-none" aria-label="Toggle Menu">
        <div class="w-6 h-4 relative flex flex-col justify-between hamburger-lines">
          <span class="w-full h-[2px] bg-vantablack transition-transform duration-300 origin-left line-1"></span>
          <span class="w-full h-[2px] bg-vantablack transition-opacity duration-300 line-2"></span>
          <span class="w-full h-[2px] bg-vantablack transition-transform duration-300 origin-left line-3"></span>
        </div>
      </button>
    </div>
  </div>

  <div id="mobile-menu" class="fixed top-0 left-0 w-full h-[100dvh] bg-vantablack z-[5001]">
    
    <div class="relative w-full h-full flex flex-col items-center justify-center menu-content">
      <nav class="flex flex-col items-center gap-8">
        <a href="#trust-bar" class="mobile-link text-4xl font-black uppercase tracking-tighter text-ghost-white hover:text-signal-orange transition-colors">Dlaczego My</a>
        <a href="#katalog" class="mobile-link text-4xl font-black uppercase tracking-tighter text-ghost-white hover:text-signal-orange transition-colors">Katalog</a>
        <a href="#logistyka" class="mobile-link text-4xl font-black uppercase tracking-tighter text-ghost-white hover:text-signal-orange transition-colors">Logistyka</a>
        <a href="#kontakt" class="mobile-link text-4xl font-black uppercase tracking-tighter text-ghost-white hover:text-signal-orange transition-colors">Kontakt</a>
      </nav>
      <div class="absolute bottom-12 flex flex-col items-center opacity-30">
        <span class="text-xs font-mono text-cool-grey uppercase tracking-widest italic">Nomad Heritage System</span>
      </div>
    </div>

  </div>
</header>

<style>
  /* GŁÓWNA INICJALIZACJA UKRYCIA MENU */
  #mobile-menu {
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }

  /* Animacja zawartości (tekst wyłania się po ułamku sekundy, żeby zabić skakanie ekranu) */
  #mobile-menu .menu-content {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.4s ease, transform 0.4s ease;
  }

  /* --- STANY PO OTWARCIU MENU --- */

  /* Pokazujemy czarne tło */
  header.menu-open #mobile-menu {
    visibility: visible;
    opacity: 1;
    pointer-events: auto;
  }

  /* Opóźnione, eleganckie wjechanie linków (0.15s opóźnienia) */
  header.menu-open #mobile-menu .menu-content {
    opacity: 1;
    transform: translateY(0);
    transition-delay: 0.15s; 
  }

  /* Nadpisujemy kolory Headera na białe, gdy czarne menu jest otwarte */
  header.menu-open {
    background-color: transparent !important;
    border-color: transparent !important;
    backdrop-filter: none !important;
  }
  
  header.menu-open .logo-primary,
  header.menu-open .logo-secondary,
  header.menu-open .logo-tertiary {
    color: #F9FAFB !important; /* Ghost White */
  }

  header.menu-open #cta-btn {
    border-color: #F9FAFB !important;
    color: #F9FAFB !important;
  }

  /* Transformacja Hamburgera w krzyżyk (X) */
header.menu-open .hamburger-lines span {
    background-color: #F9FAFB !important;
  }

  /* PERFEKCYJNY X - Zjazd do środka i rotacja z centrum */
  header.menu-open .line-1 {
    transform-origin: center !important;
    transform: translateY(7px) rotate(45deg);
  }

  header.menu-open .line-2 {
    opacity: 0;
  }

  header.menu-open .line-3 {
    transform-origin: center !important;
    transform: translateY(-7px) rotate(-45deg);
  }
</style>

{/* Piekielnie szybki, niezależny od frameworka skrypt menu */}
<script is:inline>
  (function() {
    function initHeader() {
      const toggleBtn = document.getElementById('menu-toggle');
      const header = document.getElementById('main-header');
      const mobileLinks = document.querySelectorAll('.mobile-link');

      if (!toggleBtn || !header) return;

      // Zabezpieczenie przed przypisaniem podwójnych eventów
      if (header.classList.contains('js-initialized')) return;
      header.classList.add('js-initialized');

      let isOpen = false;

      const toggleMenu = () => {
        isOpen = !isOpen;

        if (isOpen) {
          // Zablokowanie scrolla
          document.body.style.overflow = 'hidden';
          // Całą magię renderowania i kolorów od teraz robi klasa .menu-open w CSS!
          header.classList.add('menu-open');
        } else {
          // Odblokowanie scrolla
          document.body.style.overflow = '';
          // Powrót do normalności
          header.classList.remove('menu-open');
        }
      };

      toggleBtn.addEventListener('click', toggleMenu);
      
      // Zamknięcie po kliknięciu w link na telefonie
      mobileLinks.forEach(link => {
        link.addEventListener('click', () => {
          if (isOpen) toggleMenu();
        });
      });
    }

    // 1. Uruchomienie standardowe (klasyczny tryb bez ClientRoutera)
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initHeader);
    } else {
      initHeader();
    }

    // 2. Zabezpieczenie na przyszłość (jeśli kiedyś przywrócisz SPA w Astro)
    document.addEventListener('astro:page-load', initHeader);
  })();
</script>